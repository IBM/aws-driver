AWSTemplateFormatVersion: 2010-09-09
Description: Transit Gateway Route Table Attachment and Association for Transit Gateway peer attachment for cidr {{ destination_vpc_cidr }} and TGW Peer attachment {{ transit_gateway_peer_attachment_id }}.

# this is created only when public_private != 'public' - see resourcedriver createtgwroutetableassociation

Resources:
  TransitGatewayRoute:
    Type: AWS::EC2::TransitGatewayRoute
    Properties:
      Blackhole: false
      DestinationCidrBlock: {{ subnet_cidr }}
      TransitGatewayAttachmentId: {{tgw_peer_attachment_id}}
      TransitGatewayRouteTableId: {{transit_route_table_id}}
  TransitGatewayAttachmentAssociation:
    Type: AWS::EC2::TransitGatewayRouteTableAssociation
    Properties:
      TransitGatewayAttachmentId: {{tgw_peer_attachment_id}}
      TransitGatewayRouteTableId: {{transit_route_table_id}}

Outputs:
  TGWRTID:
    Description: A reference to the created Transit Gateway Route Table
    Value: !Ref TransitGatewayRoute
